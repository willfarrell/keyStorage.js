/*
 * will Farrell
 */// localStorage db wrapper

function Storage(e){return e=="sessionStorage"?this.storage=sessionStorage:this.storage=localStorage,this.on=!1,this.test=function(){try{var e=+(new Date);result=this.get(e,e)===e,this.remove(e),this.on=result}catch(t){}return this.on},this.get=function(e,t){var n=this.storage.getItem(e);return n===null?(typeof t!="undefined"&&this.set(e,t),t):(n&&n.match(/^[{\["]/)?n=JSON.parse(n):n==="true"?n=!0:n==="false"?n=!1:Number(n)&&(n=parseFloat(n)),n)},this.set=function(e,t){return t==null&&(t=""),e!==null&&this.storage.setItem(e,typeof t=="object"?JSON.stringify(t):t),t},this.remove=function(e){this.storage.removeItem(e)},this.clear=function(){this.storage.clear()},this}function keyStoarage(e,t){this.id=e?e+"_":"_",this.keys=db.get(this.id+"keys",[]),this.obj=t||{}}keyStoarage.prototype.get=function(e,t){var n={};return typeof t=="function"?n=t():n=t,db.get(this.id+e,n)},keyStoarage.prototype.set=function(e,t){if(t==="undefined"||e==="undefined")return;db.set(this.id+e,t);var n=this.keys.indexOf(e);n===-1&&(this.keys.push(e),db.set(this.id+"keys",this.keys))},keyStoarage.prototype.remove=function(e){db.remove(this.id+e);var t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),db.set(this.id+"keys",this.keys))},keyStoarage.prototype.getAllArray=function(e,t){var n=[],r=[];typeof t=="function"?n=t():n=t;for(var i=0,s=this.keys.length;i<s;i++)r.push(this.get(this.keys[i]));return!r.length&&e&&n&&(this.setAllArray(e,n),r=n),r},keyStoarage.prototype.getAllObject=function(e){var t={},n={};typeof e=="function"?t=e():t=e;for(var r=0,i=this.keys.length;r<i;r++)n[this.keys[r]]=this.get(this.keys[r]);return!n.length&&t&&(this.setAllObject(t),n=t),n},keyStoarage.prototype.setArray=function(e,t){if(!e)return;for(var n=0,r=t.length;n<r;n++)this.set(t[n][e],t[n])},keyStoarage.prototype.setObject=function(e){for(var t in e)e.hasOwnProperty(t)&&this.set(t,e[t])},keyStoarage.prototype.setAllArray=function(e,t){if(!e)return;this.clear(),this.setArray(e,t)},keyStoarage.prototype.setAllObject=function(e){this.clear(),this.setObject(e)},keyStoarage.prototype.clear=function(){for(var e=0,t=this.keys.length;e<t;e++)db.remove(this.id+this.keys[e]);db.remove(this.id+"keys")}